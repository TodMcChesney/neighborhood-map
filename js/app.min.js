function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map"),{center:{lat:46.203356,lng:6.146466},zoom:12,mapTypeControl:!1}),ko.applyBindings(new ViewModel)}function errorMap(){"use strict";window.alert("Unfortunately Google Maps did not load correctly. Please try refreshing your browser!")}var map,model=[{title:"Jet d'Eau",location:{lat:46.207389,lng:6.155903}},{title:"L'horloge Fleurie",location:{lat:46.204192,lng:6.150989}},{title:"Brunswick Monument",location:{lat:46.208445,lng:6.148912}},{title:"Bâtiment des Forces Motrices",location:{lat:46.204654,lng:6.137087}},{title:"St. Pierre Cathedral",location:{lat:46.201127,lng:6.148516}},{title:"Musée d'Art et d'Histoire (Geneva)",location:{lat:46.199304,lng:6.151574}},{title:"Musée d'ethnographie de Genève",location:{lat:46.197954,lng:6.137029}},{title:"Beth Yaakov Synagogue",location:{lat:46.20283,lng:6.14102}},{title:"Basilica of Our Lady of Geneva",location:{lat:46.208759,lng:6.142055}},{title:"Reformation Wall",location:{lat:46.200272,lng:6.14585}}],ViewModel=function(){"use strict";var t,e,i,o=this,n=function(t,e){if(e.marker!==t){e.marker=t,e.setContent("<h3>Loading please wait...</h3>"),e.open(map,t);var i,o,n=setTimeout(function(){e.setContent("<h3>"+t.title+"</h3><p>Unfortunately more information on "+t.title+" was unavailable from Wikipedia.</p>")},3e3);$.ajax({url:"https://en.wikipedia.org/w/api.php",data:{action:"opensearch",search:t.title,format:"json"},dataType:"jsonp",success:function(a){(i=a[2][0]).length>150&&(i=i.slice(0,147)+"..."),o=a[3][0],clearTimeout(n),e.setContent("<h3>"+t.title+"</h3><p>"+i+'</p><a href="'+o+'" target="_blank" >Read more on Wikipedia</a>')}}),e.addListener("closeclick",function(){e.marker=null})}},a=ko.observableArray([]),l=new google.maps.InfoWindow({maxWidth:160});model.forEach(function(o,s){t=o.location,e=o.title,(i=new google.maps.Marker({position:t,title:e,animation:google.maps.Animation.DROP,id:s})).addListener("click",function(){i=this,map.setCenter(i.getPosition()),n(i,l),i.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){i.setAnimation(null)},700)}),a.push(i)}),this.placeNameClick=function(t){google.maps.event.trigger(t,"click")},o.filter=ko.observable(""),this.filteredPlacesList=ko.computed(function(){var t=o.filter().toLowerCase();return a().forEach(function(t){t.setVisible(!0),l.close()}),t?ko.utils.arrayFilter(a(),function(e){return-1!==e.title.toLowerCase().indexOf(t)||(e.setVisible(!1),!1)}):a()},this);var s=new google.maps.LatLngBounds;this.filteredPlacesList().forEach(function(t){t.setMap(map),s.extend(t.position)}),map.fitBounds(s),this.recenterMap=function(){map.setCenter(new google.maps.LatLng(46.203356,6.146466))},o.showListView=ko.observable(!0),this.toggleListView=function(){o.showListView(!o.showListView())},ko.bindingHandlers.fadeVisible={update:function(t,e){!0===ko.unwrap(e())?$(t).fadeIn():$(t).fadeOut()}}};